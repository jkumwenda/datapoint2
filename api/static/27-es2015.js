(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{Ji0x:function(e,t,i){"use strict";i.r(t),i.d(t,"MileageModule",(function(){return ne}));var a=i("ofXK"),r=i("tyNb"),o=i("mrSG"),c=i("T2nI"),n=i("NiRy"),s=i("Jdlf"),d=i("fXoL"),l=i("a9NN"),b=i("4PCd"),m=i("Mtp9"),g=i("njyG");const p=function(){return["/add-mileage"]};function u(e,t){1&e&&(d.Rb(0,"button",7),d.Hc(1," Mileage Declaration "),d.Qb()),2&e&&d.mc("routerLink",d.pc(1,p))}function h(e,t){if(1&e){const e=d.Sb();d.Rb(0,"span",15),d.cc("click",(function(){d.wc(e);const t=d.gc().$implicit;return d.gc(2).view(t.workflow_id)})),d.Nb(1,"i",16),d.Qb()}}function f(e,t){if(1&e){const e=d.Sb();d.Rb(0,"span",17),d.cc("click",(function(){d.wc(e);const t=d.gc().$implicit;return d.gc(2).edit(t.workflow_id)})),d.Nb(1,"i",18),d.Qb()}}function v(e,t){if(1&e){const e=d.Sb();d.Rb(0,"span",19),d.cc("click",(function(){d.wc(e);const t=d.gc().$implicit;return d.gc(2).delete(t.workflow_id)})),d.Nb(1,"i",20),d.Qb()}}function R(e,t){if(1&e&&(d.Rb(0,"tr"),d.Rb(1,"td"),d.Hc(2),d.hc(3,"date"),d.Qb(),d.Rb(4,"td"),d.Hc(5),d.Qb(),d.Rb(6,"td"),d.Hc(7,"In Progress"),d.Qb(),d.Rb(8,"td"),d.Hc(9),d.hc(10,"date"),d.Qb(),d.Rb(11,"td",11),d.Fc(12,h,2,0,"span",12),d.Fc(13,f,2,0,"span",13),d.Fc(14,v,2,0,"span",14),d.Qb(),d.Qb()),2&e){const e=t.$implicit,i=d.gc(2);d.zb(2),d.Kc(" TML/",e.process.process_code," ",d.jc(3,8,e.date,"yyyy")," "),d.zb(3),d.Kc(" ",e.profile.user.first_name," ",e.profile.user.last_name," "),d.zb(4),d.Ic(d.ic(10,11,e.date)),d.zb(3),d.mc("ngIf",i.checkButton("view-mileage")),d.zb(1),d.mc("ngIf",i.checkButton("edit-mileage")),d.zb(1),d.mc("ngIf",i.checkButton("edit-afp"))}}function Q(e,t){if(1&e&&(d.Rb(0,"table",8),d.Rb(1,"thead"),d.Rb(2,"tr"),d.Rb(3,"th"),d.Hc(4,"Ref ID"),d.Qb(),d.Rb(5,"th"),d.Hc(6,"Requested By"),d.Qb(),d.Rb(7,"th"),d.Hc(8,"Status"),d.Qb(),d.Rb(9,"th"),d.Hc(10,"Date"),d.Qb(),d.Rb(11,"th",9),d.Hc(12,"Options"),d.Qb(),d.Qb(),d.Qb(),d.Rb(13,"tbody"),d.Fc(14,R,15,13,"tr",10),d.Qb(),d.Qb()),2&e){const e=d.gc();d.mc("dtOptions",e.dtOptions),d.zb(14),d.mc("ngForOf",e.requests)}}let M=(()=>{class e{constructor(e,t,i,a){this.requestService=e,this.route=t,this.rolePermissionsState=i,this.sidebarService=a,this.dtOptions=s.a}getRequests(){return Object(o.a)(this,void 0,void 0,(function*(){try{this.requests=yield this.requestService.getRequests("requests","process_code="+c.a.AddMileage)}catch(e){}}))}view(e){this.route.navigate(["mileage",e])}delete(e){}edit(e){this.route.navigate(["edit-mileage",e])}checkButton(e){return Object(n.a)(this.rolePermissionsState,e)}ngOnInit(){this.getRequests(),this.sidebarService.setTitle("myRequests")}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(l.a),d.Mb(r.b),d.Mb(b.a),d.Mb(m.a))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-mileages"]],decls:9,vars:2,consts:[[1,"card","login-card","dropdown-all","w-100"],[1,"card-header","card-header-customer"],[1,"card-body","login-card-body"],[1,"text-left"],["class","btn btn-primary btn-sm mdi mdi-plus-circle",3,"routerLink",4,"ngIf"],[1,"table-responsive"],["class","table table-striped table-bordered","datatable","",3,"dtOptions",4,"ngIf"],[1,"btn","btn-primary","btn-sm","mdi","mdi-plus-circle",3,"routerLink"],["datatable","",1,"table","table-striped","table-bordered",3,"dtOptions"],[1,"text-right"],[4,"ngFor","ngForOf"],[1,"text-right","option-data"],["class","control text-secondary","title","View Item",3,"click",4,"ngIf"],["class","control text-secondary","title","Edit Item",3,"click",4,"ngIf"],["class","control text-secondary","title","Delete Item",3,"click",4,"ngIf"],["title","View Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-eye","option-icon"],["title","Edit Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-lead-pencil","option-icon"],["title","Delete Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-trash-can","option-icon"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"strong"),d.Hc(3,"Mileage Declarations "),d.Qb(),d.Qb(),d.Rb(4,"div",2),d.Rb(5,"p",3),d.Fc(6,u,2,2,"button",4),d.Qb(),d.Rb(7,"div",5),d.Fc(8,Q,15,2,"table",6),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.zb(6),d.mc("ngIf",t.checkButton("add-afp")),d.zb(2),d.mc("ngIf",t.requests))},directives:[a.l,r.c,g.a,a.k],pipes:[a.d],styles:[""]}),e})();var k=i("3Pt+"),_=i("YqHM"),y=i("7o2P");let D=(()=>{class e{constructor(e){this.commonService=e,this.endpoint="mileages/"}addMileage(e){return new Promise((t,i)=>{this.commonService.post(this.endpoint,e).then(e=>{t(e)},e=>{i(e)})})}getMileages(){return new Promise((e,t)=>{this.commonService.get(this.endpoint).then(t=>{e(t)},e=>{t(e)})})}getMileage(e){return new Promise((t,i)=>{this.commonService.get(this.endpoint+e+"/").then(e=>{t(e)},e=>{i(e)})})}editMileage(e,t){return new Promise((i,a)=>{this.commonService.update(this.endpoint+e+"/",t).then(e=>{i(!0)},e=>{a(!1)})})}deleteMileage(e){return new Promise((t,i)=>{this.commonService.delete(this.endpoint+e+"/").then(e=>{t(!0)},e=>{i(!1)})})}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(y.a))},e.\u0275prov=d.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),w=(()=>{class e{constructor(e){this.commonService=e,this.endpoint="mileage_details/"}addMileageDetail(e){return new Promise((t,i)=>{this.commonService.post(this.endpoint,e).then(e=>{t(e)},e=>{i(e)})})}getMileageDetails(e){return new Promise((t,i)=>{this.commonService.get(`${this.endpoint}?fk_mileageid=${e}`).then(e=>{t(e)},e=>{i(e)})})}getMileageDetail(e){return new Promise((t,i)=>{this.commonService.get(this.endpoint+e+"/").then(e=>{t(e)},e=>{i(e)})})}editMileageDetail(e,t){return new Promise((i,a)=>{this.commonService.update(this.endpoint+e+"/",t).then(e=>{i(e)},e=>{a(!1)})})}deleteMileageDetail(e){return new Promise((t,i)=>{this.commonService.delete(this.endpoint+e+"/").then(e=>{t(!0)},e=>{i(!1)})})}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(y.a))},e.\u0275prov=d.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var I=i("SYt/");function H(e,t){if(1&e){const e=d.Sb();d.Rb(0,"tr"),d.Rb(1,"td"),d.Hc(2),d.Qb(),d.Rb(3,"td"),d.Hc(4),d.Qb(),d.Rb(5,"td"),d.Hc(6),d.Qb(),d.Rb(7,"td"),d.Hc(8),d.Qb(),d.Rb(9,"td"),d.Hc(10),d.Qb(),d.Rb(11,"td"),d.Hc(12),d.Qb(),d.Rb(13,"td",3),d.Rb(14,"span",4),d.cc("click",(function(){d.wc(e);const i=t.$implicit;return d.gc().edit(i.pk_mileage_detailid)})),d.Nb(15,"i",5),d.Qb(),d.Rb(16,"span",6),d.cc("click",(function(){d.wc(e);const i=t.$implicit;return d.gc().delete(i.pk_mileage_detailid)})),d.Nb(17,"i",7),d.Qb(),d.Qb(),d.Qb()}if(2&e){const e=t.$implicit;d.zb(2),d.Ic(e.date),d.zb(2),d.Ic(e.start_km),d.zb(2),d.Ic(e.end_km),d.zb(2),d.Ic(e.own_km),d.zb(2),d.Ic(e.company_km),d.zb(2),d.Ic(e.home_office)}}let S=(()=>{class e{constructor(){this.editMileageEvent=new d.n,this.deleteMileageEvent=new d.n}edit(e){this.editMileageEvent.emit(e)}delete(e){this.deleteMileageEvent.emit(e)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Gb({type:e,selectors:[["app-mileage-details"]],inputs:{mileageDetails:"mileageDetails"},outputs:{editMileageEvent:"editMileageEvent",deleteMileageEvent:"deleteMileageEvent"},decls:19,vars:1,consts:[[1,"table","table-striped","table-bordered"],["width","80",1,"text-right"],[4,"ngFor","ngForOf"],[1,"text-right","option-data"],["title","Edit Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-lead-pencil","option-icon"],["title","Delete Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-trash-can","option-icon"]],template:function(e,t){1&e&&(d.Rb(0,"table",0),d.Rb(1,"thead"),d.Rb(2,"tr"),d.Rb(3,"th"),d.Hc(4,"Date"),d.Qb(),d.Rb(5,"th"),d.Hc(6,"Start KM"),d.Qb(),d.Rb(7,"th"),d.Hc(8,"End KM"),d.Qb(),d.Rb(9,"th"),d.Hc(10,"Own KM"),d.Qb(),d.Rb(11,"th"),d.Hc(12,"Office KM"),d.Qb(),d.Rb(13,"th"),d.Hc(14,"Home Office"),d.Qb(),d.Rb(15,"th",1),d.Hc(16,"Options"),d.Qb(),d.Qb(),d.Qb(),d.Rb(17,"tbody"),d.Fc(18,H,18,6,"tr",2),d.Qb(),d.Qb()),2&e&&(d.zb(18),d.mc("ngForOf",t.mileageDetails))},directives:[a.k],styles:[""]}),e})();function q(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," date is required "),d.Qb())}function F(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," start km is required is required "),d.Qb())}function O(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," End KM required "),d.Qb())}function z(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," own KM required "),d.Qb())}function N(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," End KM required "),d.Qb())}function x(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," office km is required is required "),d.Qb())}function K(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," Bank details is required "),d.Qb())}function E(e,t){1&e&&d.Nb(0,"i",25)}function C(e,t){1&e&&(d.Rb(0,"span"),d.Hc(1,"Update"),d.Qb())}let j=(()=>{class e{constructor(e,t,i,a,r,o){this.formBuilder=e,this.mileageService=t,this.mileageDetailService=i,this.router=a,this.processService=r,this.sidebarService=o,this.mileageDetails=[]}editMileageDetail(e){return Object(o.a)(this,void 0,void 0,(function*(){try{const t=yield this.mileageDetailService.editMileageDetail(e.pk_mileage_detailid,e);this.mileageDetails.push(t),this.editMode=!1}catch(t){}}))}addMileageDetails(){return Object(o.a)(this,void 0,void 0,(function*(){const e=Object.assign(Object.assign({},this.addMileageForm.value),{fk_mileageid:this.mileage.pk_mileageid});if(e.pk_mileage_detailid)this.editMileageDetail(e);else try{const t=yield this.mileageDetailService.addMileageDetail(e);this.mileageDetails.push(t)}catch(t){}}))}addMileage(){return Object(o.a)(this,void 0,void 0,(function*(){if(!this.mileage){console.log(this.processId);try{this.mileage=yield this.mileageService.addMileage({fk_processid:this.processId})}catch(e){}}this.addMileageDetails(),this.initForm()}))}handleEditMileage(e){const t=this.mileageDetails.findIndex(t=>t.pk_mileage_detailid===e),i=this.mileageDetails.splice(t,1);this.editMode=!0,this.initForm(i[0])}handleDeleteMileage(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=this.mileageDetails.findIndex(t=>t.pk_mileage_detailid===e);try{yield this.mileageDetailService.deleteMileageDetail(e),this.mileageDetails.splice(t,1)}catch(i){}}))}navigateToDetails(){this.router.navigate(["/mileage",this.mileage.pk_mileageid])}ngOnInit(){Object(_.a)(c.a.AddMileage,this.processService).then(e=>{this.processId=e}),this.initForm(),this.sidebarService.setTitle("myRequests")}initForm(e={}){this.addMileageForm=this.formBuilder.group({pk_mileage_detailid:e.pk_mileage_detailid,start_km:[e.start_km,k.r.compose([k.r.required])],end_km:[e.end_km,k.r.compose([k.r.required])],company_km:[e.company_km,k.r.compose([k.r.required])],date:[e.date,k.r.compose([k.r.required])],home_office:[e.home_office,k.r.compose([k.r.required])],description:[e.description,[k.r.compose([k.r.required])]],own_km:[e.own_km,k.r.compose([k.r.required])],fk_mileageid:e.fk_mileageid})}get formValidation(){return this.addMileageForm.controls}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(k.b),d.Mb(D),d.Mb(w),d.Mb(r.b),d.Mb(I.a),d.Mb(m.a))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-add-mileage"]],decls:54,vars:12,consts:[[1,"card","login-card","dropdown-all","w-100"],[1,"card-header","card-header-customer"],[1,"card-body","login-card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"row"],[1,"col-2"],["for","Date"],["type","date","formControlName","date","placeholder","Date",1,"form-control"],["class","text-danger small",4,"ngIf"],["type","text","formControlName","start_km","placeholder","Start KMs",1,"form-control"],["for","own"],["type","text","formControlName","end_km","placeholder","End Kms",1,"form-control"],["type","text","formControlName","own_km","placeholder","Own Kms",1,"form-control"],["type","text","formControlName","home_office","placeholder","Home Office",1,"form-control"],["type","text","formControlName","company_km","placeholder","Company Km",1,"form-control"],[1,"col-12"],["for","description"],["id","description","placeholder","Description . . . ","rows","3","formControlName","description",1,"form-control"],[1,"btn","btn-primary"],["class","mdi mdi-plus",4,"ngIf"],[4,"ngIf"],[3,"mileageDetails","editMileageEvent","deleteMileageEvent"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-danger","small"],[1,"mdi","mdi-plus"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"strong"),d.Hc(3,"Mileage Creation Details"),d.Qb(),d.Qb(),d.Rb(4,"div",2),d.Rb(5,"form",3),d.cc("ngSubmit",(function(){return t.addMileage()})),d.Rb(6,"div",4),d.Rb(7,"div",5),d.Rb(8,"div",6),d.Rb(9,"label",7),d.Hc(10,"Date"),d.Qb(),d.Nb(11,"input",8),d.Fc(12,q,2,0,"div",9),d.Qb(),d.Rb(13,"div",6),d.Rb(14,"label",7),d.Hc(15,"Start Km"),d.Qb(),d.Nb(16,"input",10),d.Fc(17,F,2,0,"div",9),d.Qb(),d.Rb(18,"div",6),d.Rb(19,"label",11),d.Hc(20,"End KM"),d.Qb(),d.Nb(21,"input",12),d.Fc(22,O,2,0,"div",9),d.Qb(),d.Rb(23,"div",6),d.Rb(24,"label",11),d.Hc(25,"Own KM"),d.Qb(),d.Nb(26,"input",13),d.Fc(27,z,2,0,"div",9),d.Qb(),d.Rb(28,"div",6),d.Rb(29,"label",11),d.Hc(30,"Home Office"),d.Qb(),d.Nb(31,"input",14),d.Fc(32,N,2,0,"div",9),d.Qb(),d.Rb(33,"div",6),d.Rb(34,"label",7),d.Hc(35,"Company Km"),d.Qb(),d.Nb(36,"input",15),d.Fc(37,x,2,0,"div",9),d.Qb(),d.Rb(38,"div",16),d.Rb(39,"label",17),d.Hc(40,"Comment"),d.Qb(),d.Nb(41,"textarea",18),d.Fc(42,K,2,0,"div",9),d.Qb(),d.Qb(),d.Qb(),d.Rb(43,"button",19),d.Fc(44,E,1,0,"i",20),d.Fc(45,C,2,0,"span",21),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Rb(46,"div",0),d.Rb(47,"div",1),d.Rb(48,"strong"),d.Hc(49,"Mileage Details"),d.Qb(),d.Qb(),d.Rb(50,"div",2),d.Rb(51,"app-mileage-details",22),d.cc("editMileageEvent",(function(e){return t.handleEditMileage(e)}))("deleteMileageEvent",(function(e){return t.handleDeleteMileage(e)})),d.Qb(),d.Rb(52,"button",23),d.cc("click",(function(){return t.navigateToDetails()})),d.Hc(53," Submit "),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.zb(5),d.mc("formGroup",t.addMileageForm),d.zb(7),d.mc("ngIf",t.submitted&&t.formValidation.date.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.start_km.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.end_kms.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.own_km.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.end_kms.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.company_km.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.bank_details.errors),d.zb(2),d.mc("ngIf",!t.editMode),d.zb(1),d.mc("ngIf",t.editMode),d.zb(6),d.mc("mileageDetails",t.mileageDetails),d.zb(1),d.mc("disabled",!t.mileageDetails.length))},directives:[k.t,k.k,k.e,k.a,k.j,k.d,a.l,S],styles:[".card[_ngcontent-%COMP%], .col-12[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]{margin-bottom:20px}"]}),e})();var P=i("m4K9"),V=i.n(P),B=i("DaQG"),G=i.n(B),$=i("hE/2");function T(e,t){if(1&e&&(d.Rb(0,"tr"),d.Rb(1,"td"),d.Hc(2),d.Qb(),d.Rb(3,"td"),d.Hc(4),d.Qb(),d.Rb(5,"td"),d.Hc(6),d.Qb(),d.Rb(7,"td"),d.Hc(8),d.Qb(),d.Rb(9,"td"),d.Hc(10),d.Qb(),d.Rb(11,"td"),d.Hc(12),d.Qb(),d.Qb()),2&e){const e=t.$implicit;d.zb(2),d.Ic(e.date),d.zb(2),d.Ic(e.start_km),d.zb(2),d.Ic(e.end_km),d.zb(2),d.Ic(e.company_km),d.zb(2),d.Ic(e.own_km),d.zb(2),d.Ic(e.home_office)}}function J(e,t){if(1&e&&(d.Rb(0,"table",4),d.Rb(1,"thead"),d.Rb(2,"tr"),d.Rb(3,"th"),d.Hc(4,"Date"),d.Qb(),d.Rb(5,"th"),d.Hc(6,"Start KM"),d.Qb(),d.Rb(7,"th"),d.Hc(8,"End KM"),d.Qb(),d.Rb(9,"th"),d.Hc(10,"Company KM"),d.Qb(),d.Rb(11,"th"),d.Hc(12,"Own KM"),d.Qb(),d.Rb(13,"th"),d.Hc(14,"Home Office"),d.Qb(),d.Qb(),d.Qb(),d.Rb(15,"tbody"),d.Fc(16,T,13,6,"tr",5),d.Qb(),d.Qb()),2&e){const e=d.gc();d.zb(16),d.mc("ngForOf",e.mileageDetails)}}let L=(()=>{class e{constructor(e,t,i,a,r){this.activatedRoute=e,this.mileageDetailService=t,this.sidebarService=i,this.processService=a,this.requestService=r,this.downloadPDF=()=>{const e=new V.a("p","pt");e.text("Expense Sheet Details",35,20),G()(e,{html:"#table"}),G()(e,{html:"#table-2"}),e.save("mileage-details.pdf")},this.mileageId=this.activatedRoute.snapshot.params.id}getRequest(){return Object(o.a)(this,void 0,void 0,(function*(){try{const e=yield this.requestService.getRequests("requests",`fk_processid=${this.process.pk_processid}&workflowid=${this.mileageId}`);this.request=e[0]}catch(e){}}))}getProcess(){return Object(o.a)(this,void 0,void 0,(function*(){try{const e=yield this.processService.getProcessesByCode(c.a.AddMileage);this.process=e[0],this.getRequest()}catch(e){}}))}getMileageDetails(){return Object(o.a)(this,void 0,void 0,(function*(){try{this.mileageDetails=yield this.mileageDetailService.getMileageDetails(this.mileageId)}catch(e){}}))}ngOnInit(){this.getMileageDetails(),this.getProcess(),this.sidebarService.setTitle("myRequests")}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(r.a),d.Mb(w),d.Mb(m.a),d.Mb(I.a),d.Mb(l.a))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-mileage"]],decls:9,vars:6,consts:[[3,"title","downloadButtonClicked","processId","workflowid"],["id","table",1,"table","table-borderless","table-responsive"],["scope","row"],["datatable","","class","table table-bordered table-striped","id","table-2",4,"ngIf"],["datatable","","id","table-2",1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(d.Rb(0,"app-view-card",0),d.Rb(1,"table",1),d.Rb(2,"tbody"),d.Rb(3,"tr"),d.Rb(4,"th",2),d.Hc(5,"Requested by :"),d.Qb(),d.Rb(6,"td"),d.Hc(7),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Fc(8,J,17,1,"table",3),d.Qb()),2&e&&(d.mc("title","Mileage Details")("downloadButtonClicked",t.downloadPDF)("processId",t.process&&t.process.pk_processid)("workflowid",t.mileageId),d.zb(7),d.Jc(" ",t.request&&t.request.profile.user.first_name+" "+t.request.profile.user.last_name," "),d.zb(1),d.mc("ngIf",t.mileageDetails))},directives:[$.a,a.l,g.a,a.k],styles:[""]}),e})();function A(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," date is required "),d.Qb())}function U(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," start km is required is required "),d.Qb())}function X(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," End KM required "),d.Qb())}function Y(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," own KM required "),d.Qb())}function Z(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," End KM required "),d.Qb())}function W(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," office km is required is required "),d.Qb())}function ee(e,t){1&e&&(d.Rb(0,"div",24),d.Hc(1," Bank details is required "),d.Qb())}function te(e,t){1&e&&d.Nb(0,"i",25)}function ie(e,t){1&e&&(d.Rb(0,"span"),d.Hc(1,"Update"),d.Qb())}let ae=(()=>{class e{constructor(e,t,i,a,r,o,c){this.formBuilder=e,this.mileageService=t,this.mileageDetailService=i,this.router=a,this.processService=r,this.sidebarService=o,this.activatedRoute=c,this.mileageDetails=[],this.mileageId=this.activatedRoute.snapshot.params.id}getMileage(){return Object(o.a)(this,void 0,void 0,(function*(){try{this.mileage=yield this.mileageService.getMileage(this.mileageId),this.mileageDetails=this.mileage.mileageDetails,console.log(this.mileage.mileageDetails)}catch(e){}}))}editMileageDetail(e){return Object(o.a)(this,void 0,void 0,(function*(){try{const t=yield this.mileageDetailService.editMileageDetail(e.pk_mileage_detailid,e);this.mileageDetails.push(t),this.editMode=!1}catch(t){}}))}addMileageDetails(){return Object(o.a)(this,void 0,void 0,(function*(){const e=Object.assign(Object.assign({},this.addMileageForm.value),{fk_mileageid:this.mileage.pk_mileageid});if(e.pk_mileage_detailid)this.editMileageDetail(e);else try{const t=yield this.mileageDetailService.addMileageDetail(e);this.mileageDetails.push(t)}catch(t){}}))}addMileage(){return Object(o.a)(this,void 0,void 0,(function*(){if(!this.mileage){console.log(this.processId);try{this.mileage=yield this.mileageService.addMileage({fk_processid:this.processId})}catch(e){}}this.addMileageDetails(),this.initForm()}))}handleEditMileage(e){const t=this.mileageDetails.findIndex(t=>t.pk_mileage_detailid===e),i=this.mileageDetails.splice(t,1);this.editMode=!0,this.initForm(i[0])}handleDeleteMileage(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=this.mileageDetails.findIndex(t=>t.pk_mileage_detailid===e);try{yield this.mileageDetailService.deleteMileageDetail(e),this.mileageDetails.splice(t,1)}catch(i){}}))}navigateToDetails(){this.router.navigate(["/mileage",this.mileage.pk_mileageid])}ngOnInit(){Object(_.a)(c.a.AddMileage,this.processService).then(e=>{this.processId=e}),this.getMileage(),this.initForm(),this.sidebarService.setTitle("myRequests")}initForm(e={}){this.addMileageForm=this.formBuilder.group({pk_mileage_detailid:e.pk_mileage_detailid,start_km:[e.start_km,k.r.compose([k.r.required])],end_km:[e.end_km,k.r.compose([k.r.required])],company_km:[e.company_km,k.r.compose([k.r.required])],date:[e.date,k.r.compose([k.r.required])],home_office:[e.home_office,k.r.compose([k.r.required])],description:[e.description,[k.r.compose([k.r.required])]],own_km:[e.own_km,k.r.compose([k.r.required])],fk_mileageid:e.fk_mileageid})}get formValidation(){return this.addMileageForm.controls}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(k.b),d.Mb(D),d.Mb(w),d.Mb(r.b),d.Mb(I.a),d.Mb(m.a),d.Mb(r.a))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-edit-mileage"]],decls:54,vars:12,consts:[[1,"card","login-card","dropdown-all","w-100"],[1,"card-header","card-header-customer"],[1,"card-body","login-card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"row"],[1,"col-2"],["for","Date"],["type","date","formControlName","date","placeholder","Date",1,"form-control"],["class","text-danger small",4,"ngIf"],["type","text","formControlName","start_km","placeholder","Start KMs",1,"form-control"],["for","own"],["type","text","formControlName","end_km","placeholder","End Kms",1,"form-control"],["type","text","formControlName","own_km","placeholder","Own Kms",1,"form-control"],["type","text","formControlName","home_office","placeholder","Home Office",1,"form-control"],["type","text","formControlName","company_km","placeholder","Company Km",1,"form-control"],[1,"col-12"],["for","description"],["id","description","placeholder","Description . . . ","rows","3","formControlName","description",1,"form-control"],[1,"btn","btn-primary"],["class","mdi mdi-plus",4,"ngIf"],[4,"ngIf"],[3,"mileageDetails","editMileageEvent","deleteMileageEvent"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-danger","small"],[1,"mdi","mdi-plus"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"strong"),d.Hc(3,"Mileage Creation Details"),d.Qb(),d.Qb(),d.Rb(4,"div",2),d.Rb(5,"form",3),d.cc("ngSubmit",(function(){return t.addMileage()})),d.Rb(6,"div",4),d.Rb(7,"div",5),d.Rb(8,"div",6),d.Rb(9,"label",7),d.Hc(10,"Date"),d.Qb(),d.Nb(11,"input",8),d.Fc(12,A,2,0,"div",9),d.Qb(),d.Rb(13,"div",6),d.Rb(14,"label",7),d.Hc(15,"Start Km"),d.Qb(),d.Nb(16,"input",10),d.Fc(17,U,2,0,"div",9),d.Qb(),d.Rb(18,"div",6),d.Rb(19,"label",11),d.Hc(20,"End KM"),d.Qb(),d.Nb(21,"input",12),d.Fc(22,X,2,0,"div",9),d.Qb(),d.Rb(23,"div",6),d.Rb(24,"label",11),d.Hc(25,"Own KM"),d.Qb(),d.Nb(26,"input",13),d.Fc(27,Y,2,0,"div",9),d.Qb(),d.Rb(28,"div",6),d.Rb(29,"label",11),d.Hc(30,"Home Office"),d.Qb(),d.Nb(31,"input",14),d.Fc(32,Z,2,0,"div",9),d.Qb(),d.Rb(33,"div",6),d.Rb(34,"label",7),d.Hc(35,"Company Km"),d.Qb(),d.Nb(36,"input",15),d.Fc(37,W,2,0,"div",9),d.Qb(),d.Rb(38,"div",16),d.Rb(39,"label",17),d.Hc(40,"Comment"),d.Qb(),d.Nb(41,"textarea",18),d.Fc(42,ee,2,0,"div",9),d.Qb(),d.Qb(),d.Qb(),d.Rb(43,"button",19),d.Fc(44,te,1,0,"i",20),d.Fc(45,ie,2,0,"span",21),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Rb(46,"div",0),d.Rb(47,"div",1),d.Rb(48,"strong"),d.Hc(49,"Mileage Details"),d.Qb(),d.Qb(),d.Rb(50,"div",2),d.Rb(51,"app-mileage-details",22),d.cc("editMileageEvent",(function(e){return t.handleEditMileage(e)}))("deleteMileageEvent",(function(e){return t.handleDeleteMileage(e)})),d.Qb(),d.Rb(52,"button",23),d.cc("click",(function(){return t.navigateToDetails()})),d.Hc(53," Submit "),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.zb(5),d.mc("formGroup",t.addMileageForm),d.zb(7),d.mc("ngIf",t.submitted&&t.formValidation.date.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.start_km.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.end_kms.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.own_km.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.end_kms.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.company_km.errors),d.zb(5),d.mc("ngIf",t.submitted&&t.formValidation.bank_details.errors),d.zb(2),d.mc("ngIf",!t.editMode),d.zb(1),d.mc("ngIf",t.editMode),d.zb(6),d.mc("mileageDetails",t.mileageDetails),d.zb(1),d.mc("disabled",!t.mileageDetails.length))},directives:[k.t,k.k,k.e,k.a,k.j,k.d,a.l,S],styles:[""]}),e})();const re=[{path:"",component:i("jljr").a,children:[{path:"mileages",component:M},{path:"add-mileage",component:j},{path:"edit-mileage/:id",component:ae},{path:"mileage/:id",component:L}]}];let oe=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[r.f.forChild(re)],r.f]}),e})();var ce=i("WM+C");let ne=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[a.b,oe,k.o,g.b,ce.a]]}),e})()}}]);