(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{VSe1:function(e,t,r){"use strict";r.r(t),r.d(t,"ExpenseSheetModule",(function(){return K}));var i=r("ofXK"),n=r("tyNb"),c=r("mrSG"),s=r("NiRy"),o=r("Jdlf"),h=r("fXoL"),d=r("7o2P");let b=(()=>{class e{constructor(e){this.commonService=e,this.endpoint="expense_sheets/"}addExpenseSheet(e){return new Promise((t,r)=>{this.commonService.post(this.endpoint,e).then(e=>{t(e)},e=>{r(e)})})}getExpenseSheets(){return new Promise((e,t)=>{this.commonService.get(this.endpoint).then(t=>{e(t)},e=>{t(e)})})}getExpenseSheet(e){return new Promise((t,r)=>{this.commonService.get(this.endpoint+e+"/").then(e=>{t(e)},e=>{r(e)})})}editExpenseSheet(e,t){return new Promise((r,i)=>{this.commonService.update(this.endpoint+e+"/",t).then(e=>{r(e)},e=>{i(!1)})})}deleteExpenseSheet(e){return new Promise((t,r)=>{this.commonService.delete(this.endpoint+e+"/").then(e=>{t(!0)},e=>{r(!1)})})}}return e.\u0275fac=function(t){return new(t||e)(h.Zb(d.a))},e.\u0275prov=h.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=r("4PCd"),p=r("Mtp9"),a=r("njyG");const l=function(){return["/add-expense-sheet"]};function m(e,t){1&e&&(h.Rb(0,"button",6),h.Hc(1," Expense Sheet "),h.Qb()),2&e&&h.mc("routerLink",h.pc(1,l))}function v(e,t){if(1&e){const e=h.Sb();h.Rb(0,"span",14),h.cc("click",(function(){h.wc(e);const t=h.gc().$implicit;return h.gc(2).view(t.pk_expense_sheetid)})),h.Nb(1,"i",15),h.Qb()}}function f(e,t){if(1&e){const e=h.Sb();h.Rb(0,"span",16),h.cc("click",(function(){h.wc(e);const t=h.gc().$implicit;return h.gc(2).edit(t.pk_expense_sheetid)})),h.Nb(1,"i",17),h.Qb()}}function x(e,t){if(1&e){const e=h.Sb();h.Rb(0,"span",18),h.cc("click",(function(){h.wc(e);const t=h.gc().$implicit;return h.gc(2).delete(t.pk_expense_sheetid)})),h.Nb(1,"i",19),h.Qb()}}function S(e,t){if(1&e&&(h.Rb(0,"tr"),h.Rb(1,"td"),h.Hc(2),h.Qb(),h.Rb(3,"td"),h.Hc(4),h.Qb(),h.Rb(5,"td"),h.Hc(6),h.Qb(),h.Rb(7,"td"),h.Hc(8),h.Qb(),h.Rb(9,"td"),h.Hc(10),h.hc(11,"date"),h.Qb(),h.Rb(12,"td",10),h.Fc(13,v,2,0,"span",11),h.Fc(14,f,2,0,"span",12),h.Fc(15,x,2,0,"span",13),h.Qb(),h.Qb()),2&e){const e=t.$implicit,r=h.gc(2);h.zb(2),h.Jc("TML/ES ",e.pk_expense_sheetid,""),h.zb(2),h.Ic(e.from_field),h.zb(2),h.Ic(e.to),h.zb(2),h.Ic(e.currency.code+" "+e.amount),h.zb(2),h.Ic(h.ic(11,8,e.date)),h.zb(3),h.mc("ngIf",r.checkButton("view-expense-sheet")),h.zb(1),h.mc("ngIf",r.checkButton("edit-expense-sheet")),h.zb(1),h.mc("ngIf",r.checkButton("delete-expense-sheet"))}}function R(e,t){if(1&e&&(h.Rb(0,"table",7),h.Rb(1,"thead"),h.Rb(2,"tr"),h.Rb(3,"th"),h.Hc(4,"Ref ID"),h.Qb(),h.Rb(5,"th"),h.Hc(6,"From"),h.Qb(),h.Rb(7,"th"),h.Hc(8,"To"),h.Qb(),h.Rb(9,"th"),h.Hc(10,"Amount"),h.Qb(),h.Rb(11,"th"),h.Hc(12,"Date"),h.Qb(),h.Rb(13,"th",8),h.Hc(14,"Options"),h.Qb(),h.Qb(),h.Qb(),h.Rb(15,"tbody"),h.Fc(16,S,16,10,"tr",9),h.Qb(),h.Qb()),2&e){const e=h.gc();h.mc("dtOptions",e.dtOptions),h.zb(16),h.mc("ngForOf",e.expenseSheets)}}let Q=(()=>{class e{constructor(e,t,r,i){this.expenseSheetService=e,this.rolePermissionsState=t,this.router=r,this.sidebarService=i,this.dtOptions=o.a}getExpenseSheets(){return Object(c.a)(this,void 0,void 0,(function*(){try{this.expenseSheets=yield this.expenseSheetService.getExpenseSheets()}catch(e){}}))}checkButton(e){return Object(s.a)(this.rolePermissionsState,e)}edit(e){this.router.navigate(["edit-expense-sheet",e])}delete(e){}view(e){this.router.navigate(["expense-sheet",e])}ngOnInit(){this.getExpenseSheets(),this.sidebarService.setTitle("myRequests")}}return e.\u0275fac=function(t){return new(t||e)(h.Mb(b),h.Mb(u.a),h.Mb(n.b),h.Mb(p.a))},e.\u0275cmp=h.Gb({type:e,selectors:[["app-expense-sheets"]],decls:8,vars:2,consts:[[1,"card","login-card","dropdown-all","w-100"],[1,"card-header","card-header-customer"],[1,"card-body","login-card-body"],[1,"text-left"],["class","btn btn-primary btn-sm mdi mdi-plus-circle",3,"routerLink",4,"ngIf"],["datatable","","class","table table-striped table-bordered",3,"dtOptions",4,"ngIf"],[1,"btn","btn-primary","btn-sm","mdi","mdi-plus-circle",3,"routerLink"],["datatable","",1,"table","table-striped","table-bordered",3,"dtOptions"],["width","80",1,"text-right"],[4,"ngFor","ngForOf"],[1,"text-right","option-data"],["class","control text-secondary","title","View Item",3,"click",4,"ngIf"],["class","control text-secondary","title","Edit Item",3,"click",4,"ngIf"],["class","control text-secondary","title","Delete Item",3,"click",4,"ngIf"],["title","View Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-eye","option-icon"],["title","Edit Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-lead-pencil","option-icon"],["title","Delete Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-trash-can","option-icon"]],template:function(e,t){1&e&&(h.Rb(0,"div",0),h.Rb(1,"div",1),h.Rb(2,"strong"),h.Hc(3,"Expense Sheets"),h.Qb(),h.Qb(),h.Rb(4,"div",2),h.Rb(5,"p",3),h.Fc(6,m,2,2,"button",4),h.Qb(),h.Fc(7,R,17,2,"table",5),h.Qb(),h.Qb()),2&e&&(h.zb(6),h.mc("ngIf",t.checkButton("add-role")),h.zb(1),h.mc("ngIf",t.expenseSheets))},directives:[i.l,n.c,a.a,i.k],pipes:[i.d],styles:[""]}),e})();var g=r("3Pt+"),y=r("YqHM"),_=r("T2nI"),k=r("ChtM");let F=(()=>{class e{constructor(e){this.commonService=e,this.endpoint="vouchers/"}addVoucher(e){return new Promise((t,r)=>{this.commonService.post(this.endpoint,e).then(e=>{t(e)},e=>{r(e)})})}getVouchers(e){return new Promise((t,r)=>{this.commonService.get(`${this.endpoint}?fk_expense_sheetid=${e}`).then(e=>{t(e)},e=>{r(e)})})}getVoucher(e){return new Promise((t,r)=>{this.commonService.get(this.endpoint+e+"/").then(e=>{t(e)},e=>{r(e)})})}editVoucher(e,t){return new Promise((r,i)=>{this.commonService.update(this.endpoint+e+"/",t).then(e=>{r(e)},e=>{i(!1)})})}deleteVoucher(e){return new Promise((t,r)=>{this.commonService.delete(this.endpoint+e+"/").then(e=>{t(!0)},e=>{r(!1)})})}}return e.\u0275fac=function(t){return new(t||e)(h.Zb(d.a))},e.\u0275prov=h.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var I=r("SYt/");function E(e,t){if(1&e&&(h.Rb(0,"option",16),h.Hc(1),h.Qb()),2&e){const e=t.$implicit;h.nc("value",e.pk_currencyid),h.zb(1),h.Jc(" ",e.code," ")}}let w=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Gb({type:e,selectors:[["app-expense-sheet-form"]],inputs:{expenseSheetForm:"expenseSheetForm",currencies:"currencies"},decls:24,vars:2,consts:[[3,"formGroup"],["formGroupName","expenseSheet"],[1,"form-group"],[1,"row"],[1,"col-3"],["for","From"],["type","date","placeholder","From","formControlName","from_field","id","to",1,"form-control"],["for","to"],["type","date","placeholder","From","formControlName","to","id","to",1,"form-control"],[1,"col-2"],["for","currency"],["id","currency","formControlName","fk_currencyid",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-7"],["for","amount"],["type","number","placeholder","amount","formControlName","amount","id","amount",1,"form-control"],[3,"value"]],template:function(e,t){1&e&&(h.Pb(0,0),h.Rb(1,"div",1),h.Rb(2,"div",2),h.Rb(3,"div",3),h.Rb(4,"div",4),h.Rb(5,"label",5),h.Hc(6,"From"),h.Qb(),h.Nb(7,"input",6),h.Qb(),h.Rb(8,"div",4),h.Rb(9,"label",7),h.Hc(10,"To"),h.Qb(),h.Nb(11,"input",8),h.Qb(),h.Qb(),h.Rb(12,"div",3),h.Rb(13,"div",9),h.Rb(14,"div",2),h.Rb(15,"label",10),h.Hc(16,"Currency"),h.Qb(),h.Rb(17,"select",11),h.Fc(18,E,2,2,"option",12),h.Qb(),h.Qb(),h.Qb(),h.Rb(19,"div",13),h.Rb(20,"div",2),h.Rb(21,"label",14),h.Hc(22,"Amount"),h.Qb(),h.Nb(23,"input",15),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Ob()),2&e&&(h.mc("formGroup",t.expenseSheetForm),h.zb(18),h.mc("ngForOf",t.currencies))},directives:[g.k,g.e,g.f,g.a,g.j,g.d,g.q,i.k,g.m,g.l,g.s],styles:[""]}),e})(),V=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Gb({type:e,selectors:[["app-voucher-form"]],inputs:{expenseSheetForm:"expenseSheetForm"},decls:19,vars:1,consts:[[3,"formGroup"],["formGroupName","voucher"],[1,"row"],[1,"col-3"],["for","voucher_number"],["type","text","formControlName","voucher_number","id","voucher_number","placeholder","voucher number",1,"form-control"],["for","date"],["type","date","formControlName","date","id","date","placeholder","voucher number",1,"form-control"],["for","expense_incurred"],["type","number","formControlName","expense_incurred","id","expense_incurred","placeholder","Expense Incurred",1,"form-control"],["for","amount"],["type","number","formControlName","amount","id","amount","placeholder","amount",1,"form-control"]],template:function(e,t){1&e&&(h.Pb(0,0),h.Rb(1,"div",1),h.Rb(2,"div",2),h.Rb(3,"div",3),h.Rb(4,"label",4),h.Hc(5,"Voucher Number"),h.Qb(),h.Nb(6,"input",5),h.Qb(),h.Rb(7,"div",3),h.Rb(8,"label",6),h.Hc(9,"Date"),h.Qb(),h.Nb(10,"input",7),h.Qb(),h.Rb(11,"div",3),h.Rb(12,"label",8),h.Hc(13,"Expense Incurred"),h.Qb(),h.Nb(14,"input",9),h.Qb(),h.Rb(15,"div",3),h.Rb(16,"label",10),h.Hc(17,"Amount"),h.Qb(),h.Nb(18,"input",11),h.Qb(),h.Qb(),h.Qb(),h.Ob()),2&e&&h.mc("formGroup",t.expenseSheetForm)},directives:[g.k,g.e,g.f,g.a,g.j,g.d,g.m],styles:[""]}),e})();function H(e,t){if(1&e){const e=h.Sb();h.Rb(0,"tr"),h.Rb(1,"td"),h.Hc(2),h.Qb(),h.Rb(3,"td"),h.Hc(4),h.Qb(),h.Rb(5,"td"),h.Hc(6),h.Qb(),h.Rb(7,"td"),h.Hc(8),h.Qb(),h.Rb(9,"td",4),h.Rb(10,"span",5),h.cc("click",(function(){h.wc(e);const r=t.$implicit;return h.gc(2).edit(r.pk_voucherid)})),h.Nb(11,"i",6),h.Qb(),h.Rb(12,"span",7),h.cc("click",(function(){h.wc(e);const r=t.$implicit;return h.gc(2).delete(r.pk_voucherid)})),h.Nb(13,"i",8),h.Qb(),h.Qb(),h.Qb()}if(2&e){const e=t.$implicit;h.zb(2),h.Ic(e.voucher_number),h.zb(2),h.Ic(e.date),h.zb(2),h.Ic(e.expense_incurred),h.zb(2),h.Ic(e.amount)}}function O(e,t){if(1&e&&(h.Rb(0,"table",1),h.Rb(1,"thead"),h.Rb(2,"tr"),h.Rb(3,"th"),h.Hc(4,"Voucher Number"),h.Qb(),h.Rb(5,"th"),h.Hc(6,"Date"),h.Qb(),h.Rb(7,"th"),h.Hc(8,"Expense Incurred"),h.Qb(),h.Rb(9,"th"),h.Hc(10,"Amount"),h.Qb(),h.Rb(11,"th",2),h.Hc(12,"Options"),h.Qb(),h.Qb(),h.Qb(),h.Rb(13,"tbody"),h.Fc(14,H,14,4,"tr",3),h.Qb(),h.Qb()),2&e){const e=h.gc();h.zb(14),h.mc("ngForOf",e.vouchers)}}let z=(()=>{class e{constructor(){this.editVoucherEvent=new h.n,this.deleteVoucherEvent=new h.n}edit(e){this.editVoucherEvent.emit(e)}delete(e){this.deleteVoucherEvent.emit(e)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Gb({type:e,selectors:[["app-voucher-list"]],inputs:{vouchers:"vouchers"},outputs:{editVoucherEvent:"editVoucherEvent",deleteVoucherEvent:"deleteVoucherEvent"},decls:1,vars:1,consts:[["class","table table-bordered table-striped",4,"ngIf"],[1,"table","table-bordered","table-striped"],["width","80",1,"text-right"],[4,"ngFor","ngForOf"],[1,"text-right","option-data"],["title","Edit Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-lead-pencil","option-icon"],["title","Delete Item",1,"control","text-secondary",3,"click"],[1,"mdi","mdi-trash-can","option-icon"]],template:function(e,t){1&e&&h.Fc(0,O,15,1,"table",0),2&e&&h.mc("ngIf",t.vouchers)},directives:[i.l,i.k],styles:[""]}),e})(),N=(()=>{class e{constructor(e,t,r,i,n,c,s){this.formBuilder=e,this.currencyService=t,this.expenseSheetService=r,this.voucherService=i,this.router=n,this.processService=c,this.sidebarService=s,this.expenseSheet={},this.vouchers=[]}navigateToExpenseSheetView(){this.router.navigate(["expense-sheet",this.expenseSheet.pk_expense_sheetid])}addExpenseSheet(e){return Object(c.a)(this,void 0,void 0,(function*(){if(e.pk_expense_sheetid)return void this.editExpenseSheet(e);const t=Object.assign({fk_processid:this.processId},e);try{this.expenseSheet=yield this.expenseSheetService.addExpenseSheet(t),this.initForm(this.expenseSheet)}catch(r){}}))}editExpenseSheet(e){return Object(c.a)(this,void 0,void 0,(function*(){try{this.expenseSheet=yield this.expenseSheetService.editExpenseSheet(e.pk_expense_sheetid,e),this.initForm(this.expenseSheet)}catch(t){}}))}addVoucher(e){return Object(c.a)(this,void 0,void 0,(function*(){if(e.pk_voucherid)this.editVoucher(e);else try{const t=yield this.voucherService.addVoucher(Object.assign(Object.assign({},e),{fk_expense_sheetid:this.expenseSheet.pk_expense_sheetid}));this.vouchers.push(t),this.initForm(this.expenseSheet)}catch(t){}}))}handleDeleteVoucher(e){return Object(c.a)(this,void 0,void 0,(function*(){const t=this.vouchers.findIndex(t=>t.pk_voucherid===e);try{yield this.voucherService.deleteVoucher(e),this.vouchers.splice(t,1)}catch(r){}}))}handleEditVoucher(e){const t=this.vouchers.findIndex(t=>t.pk_voucherid===e),r=this.vouchers.splice(t,1);this.initForm(this.expenseSheet,r[0]),this.editMode=!0}editVoucher(e){return Object(c.a)(this,void 0,void 0,(function*(){try{const t=yield this.voucherService.editVoucher(e.pk_voucherid,e);this.editMode=!1,this.vouchers.push(t),this.initForm(this.expenseSheet)}catch(t){}}))}submit(){return Object(c.a)(this,void 0,void 0,(function*(){const{expenseSheet:e,voucher:t}=this.expenseSheetForm.value;yield this.addExpenseSheet(e),this.addVoucher(t)}))}initCurrencies(){return Object(c.a)(this,void 0,void 0,(function*(){try{this.currencies=yield this.currencyService.getCurrencies()}catch(e){}}))}ngOnInit(){Object(y.a)(_.a.AddExpenseSheet,this.processService).then(e=>this.processId=e),this.initForm(),this.initCurrencies(),this.sidebarService.setTitle("myRequests")}initForm(e={},t={}){this.expenseSheetForm=this.formBuilder.group({expenseSheet:this.formBuilder.group({pk_expense_sheetid:e.pk_expense_sheetid,fk_currencyid:[e.fk_currencyid,g.r.compose([g.r.required])],amount:[e.amount,g.r.compose([g.r.required])],from_field:[e.from_field,g.r.compose([g.r.required])],to:[e.to,g.r.compose([g.r.required])]}),voucher:this.formBuilder.group({pk_voucherid:t.pk_voucherid,fk_expense_sheetid:[this.expenseSheet.pk_expense_sheetid],voucher_number:[t.voucher_number,g.r.compose([g.r.required])],amount:[t.amount,g.r.compose([g.r.required])],date:[t.date,g.r.compose([g.r.required])],expense_incurred:[t.expense_incurred,g.r.compose([g.r.required])]})})}}return e.\u0275fac=function(t){return new(t||e)(h.Mb(g.b),h.Mb(k.a),h.Mb(b),h.Mb(F),h.Mb(n.b),h.Mb(I.a),h.Mb(p.a))},e.\u0275cmp=h.Gb({type:e,selectors:[["app-add-expense-sheet"]],decls:20,vars:7,consts:[[1,"card","login-card","dropdown-all","w-100"],[1,"card-header","card-header-customer"],[1,"card-body","login-card-body"],[3,"formGroup","ngSubmit"],[3,"expenseSheetForm","currencies"],[3,"expenseSheetForm"],["type","submit",1,"btn","btn-primary"],[3,"vouchers","deleteVoucherEvent","editVoucherEvent"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.Rb(0,"div",0),h.Rb(1,"div",1),h.Rb(2,"strong"),h.Hc(3,"Expense Details"),h.Qb(),h.Qb(),h.Rb(4,"div",2),h.Rb(5,"form",3),h.cc("ngSubmit",(function(){return t.submit()})),h.Nb(6,"app-expense-sheet-form",4),h.Nb(7,"app-voucher-form",5),h.Nb(8,"br"),h.Rb(9,"button",6),h.Hc(10),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Nb(11,"br"),h.Rb(12,"div",0),h.Rb(13,"div",1),h.Rb(14,"strong"),h.Hc(15,"Vouchers"),h.Qb(),h.Rb(16,"app-voucher-list",7),h.cc("deleteVoucherEvent",(function(e){return t.handleDeleteVoucher(e)}))("editVoucherEvent",(function(e){return t.handleEditVoucher(e)})),h.Qb(),h.Qb(),h.Rb(17,"div",2),h.Rb(18,"button",8),h.cc("click",(function(){return t.navigateToExpenseSheetView()})),h.Hc(19," Submit "),h.Qb(),h.Qb(),h.Qb()),2&e&&(h.zb(5),h.mc("formGroup",t.expenseSheetForm),h.zb(1),h.mc("expenseSheetForm",t.expenseSheetForm)("currencies",t.currencies),h.zb(1),h.mc("expenseSheetForm",t.expenseSheetForm),h.zb(3),h.Jc(" ",t.editMode?"Update Voucher":"Add"," "),h.zb(6),h.mc("vouchers",t.vouchers),h.zb(2),h.mc("disabled",0===t.vouchers.length))},directives:[g.t,g.k,g.e,w,V,z],styles:[""]}),e})();var j=r("m4K9"),M=r("DaQG"),q=r.n(M),C=r("a9NN"),D=r("hE/2");function G(e,t){if(1&e&&(h.Rb(0,"table",3),h.Rb(1,"tbody"),h.Rb(2,"tr"),h.Rb(3,"th",4),h.Hc(4,"Requested by :"),h.Qb(),h.Rb(5,"td"),h.Hc(6),h.Qb(),h.Qb(),h.Rb(7,"tr"),h.Rb(8,"th",4),h.Hc(9,"Date:"),h.Qb(),h.Rb(10,"td"),h.Hc(11),h.Qb(),h.Qb(),h.Rb(12,"tr"),h.Rb(13,"th",4),h.Hc(14,"From:"),h.Qb(),h.Rb(15,"td"),h.Hc(16),h.Qb(),h.Qb(),h.Rb(17,"tr"),h.Rb(18,"th",4),h.Hc(19,"To:"),h.Qb(),h.Rb(20,"td"),h.Hc(21),h.Qb(),h.Qb(),h.Rb(22,"tr"),h.Rb(23,"th",4),h.Hc(24,"Amount:"),h.Qb(),h.Rb(25,"td"),h.Hc(26),h.Qb(),h.Qb(),h.Qb(),h.Qb()),2&e){const e=h.gc();h.zb(6),h.Jc(" ",e.request&&e.request.profile.user.first_name+" "+e.request.profile.user.last_name," "),h.zb(5),h.Jc(" ",e.expenseSheet.date," "),h.zb(5),h.Jc(" ",e.expenseSheet.from_field," "),h.zb(5),h.Jc(" ",e.expenseSheet.to," "),h.zb(5),h.Jc(" ",e.expenseSheet.currency.code+" "+e.expenseSheet.amount," ")}}function P(e,t){if(1&e&&(h.Rb(0,"tr"),h.Rb(1,"td"),h.Hc(2),h.Qb(),h.Rb(3,"td"),h.Hc(4),h.Qb(),h.Rb(5,"td"),h.Hc(6),h.Qb(),h.Rb(7,"td"),h.Hc(8),h.Qb(),h.Qb()),2&e){const e=t.$implicit;h.zb(2),h.Ic(e.voucher_number),h.zb(2),h.Ic(e.date),h.zb(2),h.Ic(e.expense_incurred),h.zb(2),h.Ic(e.amount)}}function B(e,t){if(1&e&&(h.Rb(0,"table",5),h.Rb(1,"thead"),h.Rb(2,"tr"),h.Rb(3,"th"),h.Hc(4,"Voucher Number"),h.Qb(),h.Rb(5,"th"),h.Hc(6,"Date"),h.Qb(),h.Rb(7,"th"),h.Hc(8,"Expense Incurred"),h.Qb(),h.Rb(9,"th"),h.Hc(10,"Amount"),h.Qb(),h.Qb(),h.Qb(),h.Rb(11,"tbody"),h.Fc(12,P,9,4,"tr",6),h.Qb(),h.Qb()),2&e){const e=h.gc();h.zb(12),h.mc("ngForOf",e.vouchers)}}let J=(()=>{class e{constructor(e,t,r,i,n){this.voucherService=e,this.expenseSheetService=t,this.activatedRoute=r,this.sidebarService=i,this.requestService=n,this.downloadPDF=()=>{const e=new j.jsPDF("p","pt");e.text("Expense Sheet Details",35,20),q()(e,{html:"#table"}),q()(e,{html:"#table-2"}),e.save("expense-sheet-details.pdf")},this.expenseSheetId=this.activatedRoute.snapshot.params.id}getRequest(){return Object(c.a)(this,void 0,void 0,(function*(){try{const e=yield this.requestService.getRequests("requests",`fk_processid=${this.expenseSheet.fk_processid}&workflowid=${this.expenseSheetId}`);this.request=e[0]}catch(e){}}))}getExpenseSheet(){return Object(c.a)(this,void 0,void 0,(function*(){try{this.expenseSheet=yield this.expenseSheetService.getExpenseSheet(this.expenseSheetId),this.getRequest()}catch(e){}}))}getVouchers(){return Object(c.a)(this,void 0,void 0,(function*(){try{this.vouchers=yield this.voucherService.getVouchers(this.expenseSheetId)}catch(e){}}))}ngOnInit(){this.getExpenseSheet(),this.getVouchers(),this.sidebarService.setTitle("myRequests")}}return e.\u0275fac=function(t){return new(t||e)(h.Mb(F),h.Mb(b),h.Mb(n.a),h.Mb(p.a),h.Mb(C.a))},e.\u0275cmp=h.Gb({type:e,selectors:[["app-expense-sheet"]],decls:3,vars:6,consts:[[3,"title","downloadButtonClicked","workflowid","processId"],["class","table table-borderless table-responsive","id","table",4,"ngIf"],["datatable","","class","table table-bordered table-striped","id","table-2",4,"ngIf"],["id","table",1,"table","table-borderless","table-responsive"],["scope","row"],["datatable","","id","table-2",1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(h.Rb(0,"app-view-card",0),h.Fc(1,G,27,5,"table",1),h.Fc(2,B,13,1,"table",2),h.Qb()),2&e&&(h.mc("title","Expense Sheet Details")("downloadButtonClicked",t.downloadPDF)("workflowid",t.expenseSheetId)("processId",t.expenseSheet&&t.expenseSheet.fk_processid),h.zb(1),h.mc("ngIf",t.expenseSheet),h.zb(1),h.mc("ngIf",t.vouchers))},directives:[D.a,i.l,a.a,i.k],styles:[""]}),e})(),T=(()=>{class e{constructor(e,t,r,i,n,c,s,o){this.formBuilder=e,this.currencyService=t,this.expenseSheetService=r,this.voucherService=i,this.router=n,this.processService=c,this.sidebarService=s,this.activatedRoute=o,this.expenseSheet={},this.vouchers=[],this.expenseSheetId=this.activatedRoute.snapshot.params.id}getExpenseSheet(){return Object(c.a)(this,void 0,void 0,(function*(){try{this.expenseSheet=yield this.expenseSheetService.getExpenseSheet(this.expenseSheetId),this.vouchers=this.expenseSheet.vouchers,this.initForm(this.expenseSheet)}catch(e){}}))}navigateToExpenseSheetView(){this.router.navigate(["expense-sheet",this.expenseSheet.pk_expense_sheetid])}addExpenseSheet(e){return Object(c.a)(this,void 0,void 0,(function*(){if(e.pk_expense_sheetid)return void this.editExpenseSheet(e);const t=Object.assign({fk_processid:this.processId},e);try{this.expenseSheet=yield this.expenseSheetService.addExpenseSheet(t),this.initForm(this.expenseSheet)}catch(r){}}))}editExpenseSheet(e){return Object(c.a)(this,void 0,void 0,(function*(){try{this.expenseSheet=yield this.expenseSheetService.editExpenseSheet(e.pk_expense_sheetid,e),this.initForm(this.expenseSheet)}catch(t){}}))}addVoucher(e){return Object(c.a)(this,void 0,void 0,(function*(){if(e.pk_voucherid)this.editVoucher(e);else try{const t=yield this.voucherService.addVoucher(Object.assign(Object.assign({},e),{fk_expense_sheetid:this.expenseSheet.pk_expense_sheetid}));this.vouchers.push(t),this.initForm(this.expenseSheet)}catch(t){}}))}handleDeleteVoucher(e){return Object(c.a)(this,void 0,void 0,(function*(){const t=this.vouchers.findIndex(t=>t.pk_voucherid===e);try{yield this.voucherService.deleteVoucher(e),this.vouchers.splice(t,1)}catch(r){}}))}handleEditVoucher(e){const t=this.vouchers.findIndex(t=>t.pk_voucherid===e),r=this.vouchers.splice(t,1);this.initForm(this.expenseSheet,r[0]),this.editMode=!0}editVoucher(e){return Object(c.a)(this,void 0,void 0,(function*(){try{const t=yield this.voucherService.editVoucher(e.pk_voucherid,e);this.editMode=!1,this.vouchers.push(t),this.initForm(this.expenseSheet)}catch(t){}}))}submit(){return Object(c.a)(this,void 0,void 0,(function*(){const{expenseSheet:e,voucher:t}=this.expenseSheetForm.value;yield this.addExpenseSheet(e),t.voucher_number&&this.addVoucher(t)}))}initCurrencies(){return Object(c.a)(this,void 0,void 0,(function*(){try{this.currencies=yield this.currencyService.getCurrencies()}catch(e){}}))}ngOnInit(){Object(y.a)(_.a.AddExpenseSheet,this.processService).then(e=>this.processId=e),this.initForm(),this.getExpenseSheet(),this.initCurrencies(),this.sidebarService.setTitle("myRequests")}initForm(e={},t={}){this.expenseSheetForm=this.formBuilder.group({expenseSheet:this.formBuilder.group({pk_expense_sheetid:e.pk_expense_sheetid,fk_currencyid:[e.fk_currencyid,g.r.compose([g.r.required])],amount:[e.amount,g.r.compose([g.r.required])],from_field:[e.from_field,g.r.compose([g.r.required])],to:[e.to,g.r.compose([g.r.required])]}),voucher:this.formBuilder.group({pk_voucherid:t.pk_voucherid,fk_expense_sheetid:[this.expenseSheet.pk_expense_sheetid],voucher_number:[t.voucher_number,g.r.compose([g.r.required])],amount:[t.amount,g.r.compose([g.r.required])],date:[t.date,g.r.compose([g.r.required])],expense_incurred:[t.expense_incurred,g.r.compose([g.r.required])]})})}}return e.\u0275fac=function(t){return new(t||e)(h.Mb(g.b),h.Mb(k.a),h.Mb(b),h.Mb(F),h.Mb(n.b),h.Mb(I.a),h.Mb(p.a),h.Mb(n.a))},e.\u0275cmp=h.Gb({type:e,selectors:[["app-edit-expense-sheet"]],decls:20,vars:7,consts:[[1,"card","login-card","dropdown-all","w-100"],[1,"card-header","card-header-customer"],[1,"card-body","login-card-body"],[3,"formGroup","ngSubmit"],[3,"expenseSheetForm","currencies"],[3,"expenseSheetForm"],["type","submit",1,"btn","btn-primary"],[3,"vouchers","deleteVoucherEvent","editVoucherEvent"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.Rb(0,"div",0),h.Rb(1,"div",1),h.Rb(2,"strong"),h.Hc(3,"Expense Details"),h.Qb(),h.Qb(),h.Rb(4,"div",2),h.Rb(5,"form",3),h.cc("ngSubmit",(function(){return t.submit()})),h.Nb(6,"app-expense-sheet-form",4),h.Nb(7,"app-voucher-form",5),h.Nb(8,"br"),h.Rb(9,"button",6),h.Hc(10),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Nb(11,"br"),h.Rb(12,"div",0),h.Rb(13,"div",1),h.Rb(14,"strong"),h.Hc(15,"Vouchers"),h.Qb(),h.Rb(16,"app-voucher-list",7),h.cc("deleteVoucherEvent",(function(e){return t.handleDeleteVoucher(e)}))("editVoucherEvent",(function(e){return t.handleEditVoucher(e)})),h.Qb(),h.Qb(),h.Rb(17,"div",2),h.Rb(18,"button",8),h.cc("click",(function(){return t.navigateToExpenseSheetView()})),h.Hc(19," Submit "),h.Qb(),h.Qb(),h.Qb()),2&e&&(h.zb(5),h.mc("formGroup",t.expenseSheetForm),h.zb(1),h.mc("expenseSheetForm",t.expenseSheetForm)("currencies",t.currencies),h.zb(1),h.mc("expenseSheetForm",t.expenseSheetForm),h.zb(3),h.Jc(" ",t.editMode?"Update Voucher":t.expenseSheetForm.value.voucher.voucher_number?"Add Voucher":"Update details"," "),h.zb(6),h.mc("vouchers",t.vouchers),h.zb(2),h.mc("disabled",0===t.vouchers.length))},directives:[g.t,g.k,g.e,w,V,z],styles:[""]}),e})();const $=[{path:"",component:r("jljr").a,children:[{path:"expense-sheets",component:Q},{path:"add-expense-sheet",component:N},{path:"edit-expense-sheet/:id",component:T},{path:"expense-sheet/:id",component:J}]}];let A=(()=>{class e{}return e.\u0275mod=h.Kb({type:e}),e.\u0275inj=h.Jb({factory:function(t){return new(t||e)},imports:[[n.f.forChild($)],n.f]}),e})();var L=r("WM+C");let K=(()=>{class e{}return e.\u0275mod=h.Kb({type:e}),e.\u0275inj=h.Jb({factory:function(t){return new(t||e)},imports:[[i.b,A,g.o,a.b,L.a]]}),e})()}}]);